{"project":{"commands":[{"father":"module","command":"{\"module_name\":\"Abai\",\"module\":\"sendLogs\",\"option_\":\"INFO\",\"input_2\":\"INICIO A EXTRAER INTERACCION\"}","index":0,"execute_debugg":0,"img":"","screenshot":"","line":1,"description":"Log de inicio de secuencia ","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendLogs","id":"cd6f1b79-a294-55a0-efdf-cc5368c8498d","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.029043197631835938","extra":[]},{"father":"setVar","command":"[]","index":0,"execute_debugg":0,"img":"","screenshot":"","line":2,"description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"312bac3f-4d6d-4049-3132-24725dbd9271","group":"system","mode_live":false,"var":"tblTablaInteracciones","children":[],"else":[],"execute":1,"message":"setvar  ","time":"0.009912490844726562","extra":[]},{"father":"setVar","command":"\"\"","index":0,"execute_debugg":0,"img":"","screenshot":"","line":3,"description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"3fbaa941-2568-1602-d08c-64b6aa0751c5","group":"system","mode_live":false,"var":"strBrandId","children":[],"else":[],"execute":1,"message":"setvar  ","time":"0.006999492645263672","extra":[]},{"father":"setVar","command":"False","index":0,"execute_debugg":0,"img":"","screenshot":"","line":4,"description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"6dbed086-9429-4c26-3562-8f355e406ad8","group":"system","mode_live":false,"var":"blnExistInteracciones","children":[],"else":[],"execute":1,"message":"setvar  ","time":"0.007198333740234375","extra":[]},{"father":"trycatch","command":"","id":"b7b960b1-c2b3-d77d-489d-a1298acb94bf","group":"logic","mode_live":false,"children":[{"father":"waitforobject","command":"{\"object\":\"//*[@id=\\\"customTab20__item\\\"]\",\"wait_time\":\"60\",\"wait_for\":\"visible\",\"before\":\"\",\"after\":\"\"}","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"5.1","description":"Esperar Panel Principal","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","getvar":"blnExistInteracciones","option":"xpath","id":"50542168-58c0-6cba-e293-fdeeb076ad63","group":"web","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.040596961975097656","extra":[]},{"father":"evaluateIf","command":"{blnExistInteracciones}","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"c3aefa11-cbdb-a286-86a2-96a295840b17","group":"logic","mode_live":false,"children":[{"father":"execJs","command":"index=2\ncontinuar = true\nwhile (continuar){\n  brandId=\"#brandBand_\"+String(index)\n  console.log(document.querySelector(String(brandId)))\n  if  (!(document.querySelector(String(brandId))===null)){\n    return String(brandId).replace(\"#\",\"\")\n    //continuar = true\n  }\n  \n  index=index+1\n  if (index===200){\n    continuar=false\n  }\n}\n//return document.querySelector(\"#brandBand_6\")","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"5.2.1","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","getvar":"strBrandId","option":"latin-1","id":"998d3497-226a-553c-1c52-e87a7ee8a405","group":"web","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.011937141418457031","extra":[]},{"father":"move_to_element","command":"{\"data\":\"//*[@id=\\\"{strBrandId}\\\"]/div/div/div/one-record-home-flexipage2/forcegenerated-adg-rollup_component___force-generated__flexipage_-record-page___-o-p-a_-account-record-page___-account___-v-i-e-w/forcegenerated-flexipage_opa_accountrecordpage_account__view_js/record_flexipage-desktop-record-page-decorator/div[1]/records-record-layout-event-broker/slot/slot/flexipage-record-home-template-desktop2/div/div[2]/div[2]/slot/flexipage-component2[2]\",\"data_type\":\"xpath\"}","index":1,"execute_debugg":0,"img":"","screenshot":"","line":"5.2.2","description":"Mover hasta Knowledge","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"253c859b-ea20-f3d2-bd00-3fe34452669d","group":"web","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.02799534797668457","extra":[]},{"father":"clickWeb","command":"//*[@id=\"customTab20__item\"]","index":2,"execute_debugg":0,"img":"","screenshot":"","line":"5.2.3","description":"Clic en boton Interacciones","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","option":"xpath","id":"eee7175a-3255-9e45-cdad-44b5573c5c1a","group":"web","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.07525110244750977","extra":[]},{"father":"waitforobject","command":"{\"object\":\"/html/body/div[4]/div[1]/section/div[1]/div/div[2]/div[2]/section/div/div/section/div/div[2]/div/div/div/div/one-record-home-flexipage2/forcegenerated-adg-rollup_component___force-generated__flexipage_-record-page___-o-p-a_-account-record-page___-account___-v-i-e-w/forcegenerated-flexipage_opa_accountrecordpage_account__view_js/record_flexipage-desktop-record-page-decorator/div[1]/records-record-layout-event-broker/slot/slot/flexipage-record-home-template-desktop2/div/div[2]/div[2]/slot/flexipage-component2[5]/slot/flexipage-tabset2/div/lightning-tabset/div/slot/slot/flexipage-tab2[2]/slot/flexipage-component2/slot/flexipage-aura-wrapper/div/article/article/div[2]/lightning-datatable/div[2]/div/div/table\",\"wait_time\":\"60\",\"wait_for\":\"visible\",\"before\":\"1\",\"after\":\"\"}","index":3,"execute_debugg":0,"img":"","screenshot":"","line":"5.2.4","description":"Esperar Tabla Inferacciones","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","getvar":"blnExistInteracciones","option":"xpath","id":"a3c5c84c-efc9-7faf-00b0-9e01cd876a2c","group":"web","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"1.0431983470916748","extra":[]},{"father":"gettable_extend","command":"{\"identificator\":\"/html/body/div[4]/div[1]/section/div[1]/div/div[2]/div[2]/section/div/div/section/div/div[2]/div/div/div/div/one-record-home-flexipage2/forcegenerated-adg-rollup_component___force-generated__flexipage_-record-page___-o-p-a_-account-record-page___-account___-v-i-e-w/forcegenerated-flexipage_opa_accountrecordpage_account__view_js/record_flexipage-desktop-record-page-decorator/div[1]/records-record-layout-event-broker/slot/slot/flexipage-record-home-template-desktop2/div/div[2]/div[2]/slot/flexipage-component2[5]/slot/flexipage-tabset2/div/lightning-tabset/div/slot/slot/flexipage-tab2[2]/slot/flexipage-component2/slot/flexipage-aura-wrapper/div/article/article/div[2]/lightning-datatable/div[2]/div/div/table\",\"option\":\"xpath\",\"code\":\"Latin-1\",\"result\":\"tblTablaInteracciones\"}","index":4,"execute_debugg":0,"img":"","screenshot":"","line":"5.2.5","description":"Obtener Tabla Inferacciones","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"d7e59966-ddb2-f341-5407-94367096e03c","group":"web","mode_live":false,"execute":2,"message":"","time":"0.016034603118896484","extra":[]},{"father":"execScriptPython","command":"from dateutil import parser\n\ndef convertir_fecha(fecha_str):\n    meses = {\n        \"ene\": \"01\", \"feb\": \"02\", \"mar\": \"03\", \"abr\": \"04\", \"may\": \"05\", \"jun\": \"06\",\n        \"jul\": \"07\", \"ago\": \"08\", \"sep\": \"09\", \"oct\": \"10\", \"nov\": \"11\", \"dic\": \"12\"\n    }\n    partes = fecha_str.split()\n    dia = partes[0]\n    mes = meses[partes[1].lower()]\n    año = partes[2]\n    fecha_iso = f\"{año}-{mes}-{dia}\"\n    return fecha_iso\n\nlista_datos = eval(GetVar('tblTablaInteracciones'))\n\nfechaInteraccion = GetVar('str_fechaSolicitud')\ncoincidencia_encontrada = False\nnumero_interaccion = \"\"\n\nfor fila in lista_datos[1:]:\n    telefono = fila[1]\n    if \"Teléfono\" in telefono:\n        fecha_str = fila[2].split(\",\")[0].strip() \n        fecha_iso = convertir_fecha(fecha_str)\n        \n        try:\n            fecha = parser.parse(fecha_iso)  # Convertir la fecha a formato datetime\n            fechaInteraccion_dt = parser.parse(fechaInteraccion)  # Convertir la fecha de interacción a formato datetime\n            \n            if fecha.date() == fechaInteraccion_dt.date():\n                coincidencia_encontrada = True\n                numero_interaccion = fila[3].strip()\n                print(\"La fecha de interacción coincide con fechaInteraccion.\")\n                print(\"Número de interacción:\", numero_interaccion)\n                break\n        \n        except ValueError:\n            print(\"Formato de fecha incorrecto:\", fecha_str)\n\nif not coincidencia_encontrada:\n    print(\"No se encontraron coincidencias para la interacción\")\n    \nSetVar('str_Interaccion', numero_interaccion)","index":5,"execute_debugg":0,"img":"","screenshot":"","line":"5.2.6","description":"","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","id":"9083bd35-8ea2-c64e-eb59-4f435c0fc472","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.010997772216796875","extra":[]}],"else":[],"line":"5.2","execute":2,"index":1,"execute_debugg":0,"img":"","message":"","screenshot":"","time":"0.0","extra":{"res":"True"}},{"father":"module","command":"{\"module_name\":\"Abai\",\"module\":\"sendLogs\",\"option_\":\"INFO\",\"input_2\":\"FIN  EXTRAER INTERACCION\"}","index":2,"execute_debugg":0,"img":"","screenshot":"","line":"5.3","description":"Log de fin de secuencia ","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendLogs","id":"87bbbab3-ffa3-5ac4-30e3-a371d590f68e","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.07010436058044434","extra":[]}],"else":[{"father":"module","command":"{\"module_name\":\"Abai\",\"module\":\"sendLogs\",\"option_\":\"ERROR\",\"input_2\":\"FIN  EXTRAER INTERACCION CON ERRORES\"}","index":0,"execute_debugg":0,"img":"","screenshot":"","line":"5.1","description":"Log de fin de secuencia ","stop_onerror":false,"run_onerror":false,"stop_robot_onerror":false,"run_onerror_robot":"","run_when":"True","module":"sendLogs","id":"31421062-67f9-b1ed-4e1e-010695c39aaf","group":"scripts","mode_live":false,"children":[],"else":[],"execute":2,"message":"","time":"0.012716531753540039","extra":[]}],"line":5,"description":"Manejo de excepciones para la secuencia ","execute":1,"index":0,"execute_debugg":0,"img":"","message":"trycatch  ","screenshot":"","time":"0.0","extra":{"res":true}}],"ifs":[],"modules":[{"name":"Abai","status":"Installed","version":"1.2"}],"profile":{"name":"ExtraerInteracciones","description":""},"vars":[{"name":"blnExistInteracciones","data":"","type":"string","category":"","disabled":false,"index":0,"id":"c2b92be1-f804-2c33-d276-a4b357509ecf"},{"name":"tblTablaInteracciones","data":"","type":"string","category":"","disabled":false,"index":1,"id":"448b6003-dc80-c0d5-37b8-b5a7c0781aa0"},{"name":"strBrandId","data":"","type":"string","category":"","disabled":false},{"name":"intTiempoEspera","data":"","type":"string","category":"","disabled":true},{"name":"str_fechaSolicitud","data":"2023-08-18","type":"string","category":"Test","disabled":true},{"name":"str_Interaccion","data":"","type":"string","category":"Test","disabled":true},{"name":"blnExisteTablaCompleta","data":"","type":"string","category":"","disabled":false}],"expose":{"title":{"en":"ExtraerInteracciones expose","es":"ExtraerInteracciones expose","pr":"ExtraerInteracciones expose"},"description":{"en":"","es":"","pr":""},"form":[]}}}